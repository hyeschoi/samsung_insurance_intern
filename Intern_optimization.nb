(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     46657,       1222]
NotebookOptionsPosition[     44684,       1149]
NotebookOutlinePosition[     45041,       1165]
CellTagsIndexPosition[     44998,       1162]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"P", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p1", ",", "p2", ",", "p3", ",", "p4", ",", 
       RowBox[{"1", "-", 
        RowBox[{"(", 
         RowBox[{"p1", "+", "p2", "+", "p3", "+", "p4"}], ")"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "p5", ",", "p6", ",", "0", ",", 
       RowBox[{"1", "-", 
        RowBox[{"(", 
         RowBox[{"p5", "+", "p6"}], ")"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p7", ",", "p8", ",", "p9", ",", "0", ",", 
       RowBox[{"1", "-", 
        RowBox[{"(", 
         RowBox[{"p7", "+", "p8", "+", "p9"}], ")"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p10", ",", "p11", ",", "p12", ",", "p13", ",", 
       RowBox[{"1", "-", 
        RowBox[{"(", 
         RowBox[{"p10", "+", "p11", "+", "p12", "+", "p13"}], ")"}]}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}],
   "\n"}]], "Input",
 CellChangeTimes->{{3.677471623286311*^9, 3.677471623294403*^9}, {
  3.677489734464677*^9, 3.6774897372131977`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p1", ",", "p2", ",", "p3", ",", "p4", ",", 
     RowBox[{"1", "-", "p1", "-", "p2", "-", "p3", "-", "p4"}]}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{"0", ",", "p5", ",", "p6", ",", "0", ",", 
     RowBox[{"1", "-", "p5", "-", "p6"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p7", ",", "p8", ",", "p9", ",", "0", ",", 
     RowBox[{"1", "-", "p7", "-", "p8", "-", "p9"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p10", ",", "p11", ",", "p12", ",", "p13", ",", 
     RowBox[{"1", "-", "p10", "-", "p11", "-", "p12", "-", "p13"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.677471625474131*^9, 3.6774749755173397`*^9, 
  3.677476787480215*^9, 3.677491320535079*^9, 3.6775311022128553`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Q", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"q1", ",", "q2", ",", "q3", ",", "q4", ",", 
      RowBox[{"1", "-", 
       RowBox[{"(", 
        RowBox[{"q1", "+", "q2", "+", "q3", "+", "q4"}], ")"}]}]}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "q5", ",", "q6", ",", "0", ",", 
      RowBox[{"1", "-", 
       RowBox[{"(", 
        RowBox[{"q5", "+", "q6"}], ")"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"q7", ",", "q8", ",", "q9", ",", "0", ",", 
      RowBox[{"1", "-", 
       RowBox[{"(", 
        RowBox[{"q7", "+", "q8", "+", "q9"}], ")"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"q10", ",", "q11", ",", "q12", ",", "q13", ",", 
      RowBox[{"1", "-", 
       RowBox[{"(", 
        RowBox[{"q10", "+", "q11", "+", "q12", "+", "q13"}], ")"}]}]}], "}"}],
     ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1"}], "}"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.677477379356742*^9, 3.6774774060090923`*^9}, {
  3.67748974648136*^9, 3.6774897780447693`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"q1", ",", "q2", ",", "q3", ",", "q4", ",", 
     RowBox[{"1", "-", "q1", "-", "q2", "-", "q3", "-", "q4"}]}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{"0", ",", "q5", ",", "q6", ",", "0", ",", 
     RowBox[{"1", "-", "q5", "-", "q6"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"q7", ",", "q8", ",", "q9", ",", "0", ",", 
     RowBox[{"1", "-", "q7", "-", "q8", "-", "q9"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"q10", ",", "q11", ",", "q12", ",", "q13", ",", 
     RowBox[{"1", "-", "q10", "-", "q11", "-", "q12", "-", "q13"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6774897823032207`*^9, 3.6775311082340183`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pi", "=", 
  RowBox[{"{", 
   RowBox[{
   "0.000000000", ",", "0.979975172", ",", "0.000000000", ",", "0.000000000", 
    ",", "0.020024828"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6774716318557043`*^9, 3.677471631863522*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.`", ",", "0.979975172`", ",", "0.`", ",", "0.`", ",", "0.020024828`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.677471632997511*^9, 3.677474978310453*^9, 
  3.677476790386088*^9, 3.677491338989718*^9, 3.6775311118191957`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"observed", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "0.000000000", ",", "0.979975172", ",", "0.000000000", ",", 
      "0.000000000", ",", "0.020024828"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0.000000000", ",", "0.862657060", ",", "0.099990719", ",", 
      "0.000000000", ",", "0.037352221"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0.011775898", ",", "0.829348091", ",", "0.116059309", ",", 
      "0.000000000", ",", "0.042816702"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0.023018111", ",", "0.800053369", ",", "0.119899528", ",", 
      "0.008904435", ",", "0.048124558"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0.018272946", ",", "0.773734526", ",", "0.129244834", ",", 
      "0.023923056", ",", "0.054824638"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0.043356189", ",", "0.747641920", ",", "0.110879074", ",", 
      "0.037311615", ",", "0.060811203"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0.026115810", ",", "0.735964637", ",", "0.102287889", ",", 
      "0.067789728", ",", "0.067841936"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0.022147970", ",", "0.717390043", ",", "0.104329818", ",", 
      "0.081926607", ",", "0.074205562"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0.024967225", ",", "0.701646305", ",", "0.099938510", ",", 
      "0.092130451", ",", "0.081317508"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0.019937814", ",", "0.692596847", ",", "0.093389254", ",", 
      "0.105304375", ",", "0.088771710"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0.018464376", ",", "0.683228336", ",", "0.088771710", ",", 
      "0.114156602", ",", "0.095378975"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0.019119882", ",", "0.670808534", ",", "0.085958256", ",", 
      "0.121796434", ",", "0.102316893"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0.016236817", ",", "0.642436161", ",", "0.089235785", ",", 
      "0.128409500", ",", "0.123681737"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0.015592914", ",", "0.632760201", ",", "0.086822596", ",", 
      "0.132023482", ",", "0.132800807"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0.020436694", ",", "0.617933011", ",", "0.083777105", ",", 
      "0.137458958", ",", "0.140394232"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0.015500099", ",", "0.611743413", ",", "0.080720012", ",", 
      "0.144124233", ",", "0.147912243"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0.014026661", ",", "0.605867066", ",", "0.076346107", ",", 
      "0.146995696", ",", "0.156764470"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0.014844593", ",", "0.596568167", ",", "0.074721845", ",", 
      "0.149774344", ",", "0.164091051"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0.012152959", ",", "0.591695381", ",", "0.071983804", ",", 
      "0.151474018", ",", "0.172693838"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0.011607671", ",", "0.588046593", ",", "0.067754922", ",", 
      "0.152605200", ",", "0.179985614"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0.012431404", ",", "0.580551785", ",", "0.066803569", ",", 
      "0.154043832", ",", "0.186169411"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0.010505493", ",", "0.575806620", ",", "0.064494797", ",", 
      "0.154426694", ",", "0.194766396"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0.009704964", ",", "0.569524207", ",", "0.063485434", ",", 
      "0.155233024", ",", "0.202052371"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0.011514856", ",", "0.561379694", ",", "0.062505076", ",", 
      "0.155929136", ",", "0.208671238"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0.009432320", ",", "0.558328403", ",", "0.058554639", ",", 
      "0.156161173", ",", "0.217523465"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0.008185119", ",", "0.548147761", ",", "0.060381934", ",", 
      "0.156282993", ",", "0.227002193"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0.011120393", ",", "0.539040293", ",", "0.057493068", ",", 
      "0.156161173", ",", "0.236185073"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0.009583145", ",", "0.535948395", ",", "0.052191013", ",", 
      "0.150563271", ",", "0.251714176"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0.009066862", ",", "0.528639217", ",", "0.052185212", ",", 
      "0.137836019", ",", "0.272272690"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0.008121309", ",", "0.522066757", ",", "0.052759505", ",", 
      "0.126495191", ",", "0.290557238"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0.007216363", ",", "0.518980660", ",", "0.049313749", ",", 
      "0.101748402", ",", "0.322740826"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0.008852227", ",", "0.511729491", ",", "0.048954091", ",", 
      "0.089311197", ",", "0.341152994"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0.008196721", ",", "0.506108385", ",", "0.048350794", ",", 
      "0.080888239", ",", "0.356455861"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0.006891511", ",", "0.504286891", ",", "0.044377154", ",", 
      "0.069408189", ",", "0.375036256"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0.006711682", ",", "0.496124975", ",", "0.045833188", ",", 
      "0.061420301", ",", "0.389909853"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0.006253408", ",", "0.492998271", ",", "0.042271414", ",", 
      "0.054215540", ",", "0.404261367"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6774716543469267`*^9, 3.67747165927592*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.979975172`", ",", "0.`", ",", "0.`", ",", "0.020024828`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.86265706`", ",", "0.099990719`", ",", "0.`", ",", 
     "0.037352221`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.011775898`", ",", "0.829348091`", ",", "0.116059309`", ",", "0.`", ",",
      "0.042816702`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.023018111`", ",", "0.800053369`", ",", "0.119899528`", ",", 
     "0.008904435`", ",", "0.048124558`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.018272946`", ",", "0.773734526`", ",", "0.129244834`", ",", 
     "0.023923056`", ",", "0.054824638`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.043356189`", ",", "0.74764192`", ",", "0.110879074`", ",", 
     "0.037311615`", ",", "0.060811203`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.02611581`", ",", "0.735964637`", ",", "0.102287889`", ",", 
     "0.067789728`", ",", "0.067841936`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.02214797`", ",", "0.717390043`", ",", "0.104329818`", ",", 
     "0.081926607`", ",", "0.074205562`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.024967225`", ",", "0.701646305`", ",", "0.09993851`", ",", 
     "0.092130451`", ",", "0.081317508`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.019937814`", ",", "0.692596847`", ",", "0.093389254`", ",", 
     "0.105304375`", ",", "0.08877171`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.018464376`", ",", "0.683228336`", ",", "0.08877171`", ",", 
     "0.114156602`", ",", "0.095378975`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.019119882`", ",", "0.670808534`", ",", "0.085958256`", ",", 
     "0.121796434`", ",", "0.102316893`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.016236817`", ",", "0.642436161`", ",", "0.089235785`", ",", 
     "0.1284095`", ",", "0.123681737`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.015592914`", ",", "0.632760201`", ",", "0.086822596`", ",", 
     "0.132023482`", ",", "0.132800807`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.020436694`", ",", "0.617933011`", ",", "0.083777105`", ",", 
     "0.137458958`", ",", "0.140394232`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.015500099`", ",", "0.611743413`", ",", "0.080720012`", ",", 
     "0.144124233`", ",", "0.147912243`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.014026661`", ",", "0.605867066`", ",", "0.076346107`", ",", 
     "0.146995696`", ",", "0.15676447`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.014844593`", ",", "0.596568167`", ",", "0.074721845`", ",", 
     "0.149774344`", ",", "0.164091051`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.012152959`", ",", "0.591695381`", ",", "0.071983804`", ",", 
     "0.151474018`", ",", "0.172693838`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.011607671`", ",", "0.588046593`", ",", "0.067754922`", ",", 
     "0.1526052`", ",", "0.179985614`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.012431404`", ",", "0.580551785`", ",", "0.066803569`", ",", 
     "0.154043832`", ",", "0.186169411`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.010505493`", ",", "0.57580662`", ",", "0.064494797`", ",", 
     "0.154426694`", ",", "0.194766396`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.009704964`", ",", "0.569524207`", ",", "0.063485434`", ",", 
     "0.155233024`", ",", "0.202052371`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.011514856`", ",", "0.561379694`", ",", "0.062505076`", ",", 
     "0.155929136`", ",", "0.208671238`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00943232`", ",", "0.558328403`", ",", "0.058554639`", ",", 
     "0.156161173`", ",", "0.217523465`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.008185119`", ",", "0.548147761`", ",", "0.060381934`", ",", 
     "0.156282993`", ",", "0.227002193`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.011120393`", ",", "0.539040293`", ",", "0.057493068`", ",", 
     "0.156161173`", ",", "0.236185073`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.009583145`", ",", "0.535948395`", ",", "0.052191013`", ",", 
     "0.150563271`", ",", "0.251714176`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.009066862`", ",", "0.528639217`", ",", "0.052185212`", ",", 
     "0.137836019`", ",", "0.27227269`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.008121309`", ",", "0.522066757`", ",", "0.052759505`", ",", 
     "0.126495191`", ",", "0.290557238`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.007216363`", ",", "0.51898066`", ",", "0.049313749`", ",", 
     "0.101748402`", ",", "0.322740826`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.008852227`", ",", "0.511729491`", ",", "0.048954091`", ",", 
     "0.089311197`", ",", "0.341152994`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.008196721`", ",", "0.506108385`", ",", "0.048350794`", ",", 
     "0.080888239`", ",", "0.356455861`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.006891511`", ",", "0.504286891`", ",", "0.044377154`", ",", 
     "0.069408189`", ",", "0.375036256`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.006711682`", ",", "0.496124975`", ",", "0.045833188`", ",", 
     "0.061420301`", ",", "0.389909853`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.006253408`", ",", "0.492998271`", ",", "0.042271414`", ",", 
     "0.05421554`", ",", "0.404261367`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6774749801051407`*^9, {3.6774767513829107`*^9, 3.677476760018668*^9}, 
   3.677531113884858*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"observed", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6774716629045343`*^9, 3.677471666747099*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.`", ",", "0.979975172`", ",", "0.`", ",", "0.`", ",", "0.020024828`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.677471667938869*^9, 3.677531127924076*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"i", "=", "1"}], ";", 
    RowBox[{"sum", "=", "0"}], ";", 
    RowBox[{"templeft", "=", "pi"}], ";", " ", 
    RowBox[{"tempright", " ", "=", " ", "pi"}]}], ",", 
   RowBox[{"i", "<", "5"}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{
    RowBox[{"sum", "=", 
     RowBox[{"sum", "+", 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"temp", "-", 
          RowBox[{"observed", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "^", "2"}], "]"}]}]}], 
    ";", 
    RowBox[{"templeft", " ", "=", " ", 
     RowBox[{"Dot", "[", 
      RowBox[{"P", ",", " ", "temp_left"}], "]"}]}], ";", 
    RowBox[{"tempright", " ", "=", " ", 
     RowBox[{"Dot", "[", 
      RowBox[{"P", ",", " ", "temp_right"}], "]"}]}], ";", 
    RowBox[{"Print", "[", "i", "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6774748669084263`*^9, 3.67747487866506*^9}, {
  3.6774749894859953`*^9, 3.6774749960137157`*^9}, {3.677475034354982*^9, 
  3.677475034854226*^9}, {3.677489800169985*^9, 3.6774898480832033`*^9}, {
  3.6774899450668917`*^9, 3.677489991776689*^9}, {3.677531208268384*^9, 
  3.67753121448181*^9}}],

Cell[CellGroupData[{

Cell[BoxData["1"], "Print",
 CellChangeTimes->{3.6774749989712687`*^9, 3.677475036523404*^9}],

Cell[BoxData["2"], "Print",
 CellChangeTimes->{3.6774749989712687`*^9, 3.677475036531383*^9}],

Cell[BoxData["3"], "Print",
 CellChangeTimes->{3.6774749989712687`*^9, 3.677475036540371*^9}],

Cell[BoxData["4"], "Print",
 CellChangeTimes->{3.6774749989712687`*^9, 3.6774750365511303`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dot", "[", 
  RowBox[{"P", ",", "pi"}], "]"}]], "Input",
 CellChangeTimes->{{3.677475012214841*^9, 3.6774750260227137`*^9}, {
  3.677491986398808*^9, 3.67749199601145*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.979975172`", " ", "p2"}], "+", 
    RowBox[{"0.020024828`", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "p1", "-", "p2", "-", "p3", "-", "p4"}], ")"}]}]}], 
   ",", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.979975172`", " ", "p5"}], "+", 
    RowBox[{"0.020024828`", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "p5", "-", "p6"}], ")"}]}]}], ",", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.979975172`", " ", "p8"}], "+", 
    RowBox[{"0.020024828`", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "p7", "-", "p8", "-", "p9"}], ")"}]}]}], ",", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.979975172`", " ", "p11"}], "+", 
    RowBox[{"0.020024828`", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "p10", "-", "p11", "-", "p12", "-", "p13"}], 
      ")"}]}]}], ",", "0.020024828`"}], "}"}]], "Output",
 CellChangeTimes->{{3.677475027341136*^9, 3.677475043532793*^9}, 
   3.677491998756089*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", 
   RowBox[{
   "p1_", ",", "p2_", ",", "p3_", ",", "p4_", ",", "p5_", ",", "p6_", ",", 
    "p7_", ",", "p8_", ",", "p9_", ",", "p10_", ",", "p11_", ",", "p12_", ",",
     "p13_", ",", " ", "q1_", ",", "q2_", ",", "q3_", ",", "q4_", ",", 
    "\[IndentingNewLine]", "q5_", ",", "q6_", ",", "q7_", ",", "q8_", ",", 
    "q9_", ",", "q10_", ",", "q11_", ",", "q12_", ",", "q13_", ",", "w_"}], 
   "]"}], ":=", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"sum", " ", "=", " ", "0"}], ";", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"i", "=", "1"}], ";", 
       RowBox[{"templeft", "=", "pi"}], ";", 
       RowBox[{"tempright", "=", "pi"}]}], ",", 
      RowBox[{"i", "<", "12"}], ",", 
      RowBox[{"i", "++"}], ",", 
      RowBox[{
       RowBox[{"sum", "=", 
        RowBox[{"sum", "+", 
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"w", " ", "*", " ", "templeft"}], " ", "+", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "w"}], ")"}], " ", "*", " ", "tempright"}], 
             "-", 
             RowBox[{"observed", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "^", "2"}], "]"}]}]}], 
       ";", 
       RowBox[{"templeft", "=", 
        RowBox[{"Dot", "[", 
         RowBox[{"P", ",", "templeft"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"tempright", " ", "=", " ", 
        RowBox[{"Dot", "[", 
         RowBox[{"Q", ",", " ", "tempright"}], "]"}]}]}]}], "]"}], ";", " ", 
    "sum"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.67747588086931*^9, 3.6774758815112867`*^9}, {
  3.677476001796486*^9, 3.677476044210403*^9}, {3.677476294360684*^9, 
  3.677476381711503*^9}, {3.677477195751453*^9, 3.677477239285102*^9}, {
  3.677477300229424*^9, 3.677477343175212*^9}, {3.677489881223057*^9, 
  3.6774899203332367`*^9}, {3.677490013323526*^9, 3.6774901101291113`*^9}, {
  3.677492316612997*^9, 3.677492326696658*^9}, {3.677531140147599*^9, 
  3.677531157131075*^9}, {3.6775312209738693`*^9, 3.677531222637327*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Minimize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{
      "p1", ",", "p2", ",", "p3", ",", "p4", ",", "p5", ",", "p6", ",", "p7", 
       ",", "p8", ",", "p9", ",", "p10", ",", "p11", ",", "p12", ",", "p13", 
       ",", "q1", ",", "q2", ",", "q3", ",", "q4", ",", "q5", ",", "q6", ",", 
       "q7", ",", "q8", ",", "q9", ",", "q10", ",", "q11", ",", "q12", ",", 
       "q13", ",", " ", "w"}], "]"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"p1", "+", "p2", " ", "+", "p3", " ", "+", "p4"}], 
       "\[LessEqual]", " ", "1"}], "&&", 
      RowBox[{"p1", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"p2", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"p3", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"p4", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"p5", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"p6", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"p7", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"p8", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"p9", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"p10", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"p11", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"p12", "\[GreaterEqual]", "0"}], "&&", " ", 
      RowBox[{"p13", " ", "\[GreaterEqual]", "0"}], "\[IndentingNewLine]", "&&",
       " ", 
      RowBox[{
       RowBox[{"p5", "+", "p6"}], "\[LessEqual]", "1"}], "&&", 
      RowBox[{
       RowBox[{"p7", "+", "p8", "+", "p9"}], " ", "\[LessEqual]", "1"}], "&&",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"p10", "+", "p11", "+", "p12", "+", "p13"}], "\[LessEqual]", 
       "1"}], " ", "&&", " ", 
      RowBox[{
       RowBox[{"q1", "+", "q2", " ", "+", "q3", " ", "+", "q4"}], 
       "\[LessEqual]", " ", "1"}], "&&", 
      RowBox[{"q1", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"q2", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"q3", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"q4", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"q5", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"q6", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"q7", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"q8", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"q9", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"q10", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"q11", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"q12", "\[GreaterEqual]", "0"}], "&&", " ", 
      RowBox[{"q13", " ", "\[GreaterEqual]", "0"}], "\[IndentingNewLine]", "&&",
       " ", 
      RowBox[{
       RowBox[{"q5", "+", "q6"}], "\[LessEqual]", "1"}], "&&", 
      RowBox[{
       RowBox[{"q7", "+", "q8", "+", "q9"}], " ", "\[LessEqual]", "1"}], "&&",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"q10", "+", "q11", "+", "q12", "+", "q13"}], "\[LessEqual]", 
       "1"}], " ", "&&", " ", 
      RowBox[{"w", " ", "\[GreaterEqual]", " ", "0"}], " ", "&&", " ", 
      RowBox[{"w", "\[LessEqual]", "1"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "p1", ",", "p2", ",", "p3", ",", "p4", ",", "p5", ",", "p6", ",", "p7", 
     ",", "p8", ",", "p9", ",", "p10", ",", "p11", ",", "p12", ",", "p13", 
     ",", "q1", ",", "q2", ",", "q3", ",", "q4", ",", "q5", ",", "q6", ",", 
     "q7", ",", "q8", ",", "q9", ",", "q10", ",", "q11", ",", "q12", ",", 
     "q13", ",", " ", "w"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6774763997530603`*^9, 3.6774764838156557`*^9}, {
   3.6774765139772987`*^9, 3.677476631503538*^9}, {3.67749019091453*^9, 
   3.677490194601269*^9}, {3.6774902261938877`*^9, 3.677490445579751*^9}, {
   3.6774905374644213`*^9, 3.677490549358214*^9}, {3.677490583719803*^9, 
   3.6774906465440683`*^9}, 3.677491779142282*^9, {3.6774922730734797`*^9, 
   3.677492286995865*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.027981365644635152`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"p1", "\[Rule]", "0.3761363261748346`"}], ",", 
     RowBox[{"p2", "\[Rule]", "4.406821264870169`*^-7"}], ",", 
     RowBox[{"p3", "\[Rule]", "0.12383718398285115`"}], ",", 
     RowBox[{"p4", "\[Rule]", "0.07788550764818301`"}], ",", 
     RowBox[{"p5", "\[Rule]", "0.3675325751801483`"}], ",", 
     RowBox[{"p6", "\[Rule]", "0.16038265699684767`"}], ",", 
     RowBox[{"p7", "\[Rule]", "0.13281888775740222`"}], ",", 
     RowBox[{"p8", "\[Rule]", "0.27183185368540236`"}], ",", 
     RowBox[{"p9", "\[Rule]", "0.48211611970738333`"}], ",", 
     RowBox[{"p10", "\[Rule]", "0.`"}], ",", 
     RowBox[{"p11", "\[Rule]", "0.`"}], ",", 
     RowBox[{"p12", "\[Rule]", "1.5046073518563382`*^-8"}], ",", 
     RowBox[{"p13", "\[Rule]", "0.13994336165910096`"}], ",", 
     RowBox[{"q1", "\[Rule]", "0.13396419660204464`"}], ",", 
     RowBox[{"q2", "\[Rule]", "0.`"}], ",", 
     RowBox[{"q3", "\[Rule]", "0.0005908722190642282`"}], ",", 
     RowBox[{"q4", "\[Rule]", "0.0434344082230946`"}], ",", 
     RowBox[{"q5", "\[Rule]", "0.9784924396915868`"}], ",", 
     RowBox[{"q6", "\[Rule]", "0.006506957683349238`"}], ",", 
     RowBox[{"q7", "\[Rule]", "0.09875878361226774`"}], ",", 
     RowBox[{"q8", "\[Rule]", "0.06173898660188294`"}], ",", 
     RowBox[{"q9", "\[Rule]", "0.4333355453022052`"}], ",", 
     RowBox[{"q10", "\[Rule]", "0.`"}], ",", 
     RowBox[{"q11", "\[Rule]", "0.008622820131678378`"}], ",", 
     RowBox[{"q12", "\[Rule]", "0.08808715466504258`"}], ",", 
     RowBox[{"q13", "\[Rule]", "0.9032900262188447`"}], ",", 
     RowBox[{"w", "\[Rule]", "0.1556320896086744`"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.677531181013741*^9, 3.677531392025196*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"3", "*", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.677491867568995*^9, 3.6774918939949417`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "6", ",", "9"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "6", ",", "9"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "6", ",", "9"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.677491895165059*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"observed2", " ", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "0.000000000", " ", ",", "1.000000000", " ", ",", "0.000000000", " ", 
      ",", "0.000000000", " ", ",", "0.000000000"}], "}"}], ",", "\n", 
    RowBox[{"{", 
     RowBox[{
     "0.000000000", ",", "0.878500910", ",", "0.103550634", ",", 
      "0.000000000", ",", "0.017948456"}], "}"}], ",", "\n", 
    RowBox[{"{", 
     RowBox[{
     "0.012197980", " ", ",", "0.844016080", " ", ",", "0.120177141", " ", 
      ",", "0.000000000", " ", ",", "0.023608799"}], "}"}], ",", "\n", 
    RowBox[{"{", 
     RowBox[{
     "0.023843145", ",", "0.813659334", ",", "0.124167022", ",", 
      "0.009223596", ",", "0.029106904"}], "}"}], ",", "\n", 
    RowBox[{"{", 
     RowBox[{
     "0.018927900", ",", "0.786397149", ",", "0.133847291", ",", 
      "0.024780526", " ", ",", "0.036047133"}], "}"}], ",", "\n", 
    RowBox[{"{", " ", 
     RowBox[{
     "0.044910198", " ", ",", "0.759423390", " ", ",", "0.114769170", " ", 
      ",", "0.038648969", " ", ",", "0.042248274"}], "}"}], ",", "\n", 
    RowBox[{"{", 
     RowBox[{
     "0.027045866", " ", ",", "0.747297517", ",", " ", "0.105906106", ",", 
      " ", "0.070219504", ",", " ", "0.049531009"}], "}"}], ",", "\n", 
    RowBox[{"{", 
     RowBox[{
     "0.022935807", " ", ",", "0.728069174", ",", " ", "0.108015214", ",", 
      " ", "0.084857079", ",", " ", "0.056122725"}], "}"}], ",", "\n", 
    RowBox[{"{", " ", 
     RowBox[{
     "0.025862121", ",", " ", "0.711737100", ",", " ", "0.103484536", ",", 
      " ", "0.095426659", ",", " ", "0.063489584"}], "}"}], ",", "\n", 
    RowBox[{"{", 
     RowBox[{
     "0.020646433", ",", " ", "0.702363283", ",", " ", "0.096700537", ",", 
      " ", "0.109078782", ",", " ", "0.071210965"}], "}"}], ",", "\n", 
    RowBox[{"{", 
     RowBox[{
     "0.019120183", ",", " ", "0.692677006", ",", " ", "0.091899460", ",", 
      " ", "0.118248298", ",", " ", "0.078055053"}], "}"}], ",", "\n", 
    RowBox[{"{", 
     RowBox[{
     "0.019805193", ",", " ", "0.679812043", ",", " ", "0.088979155", ",", 
      " ", "0.126161963", ",", " ", "0.085241646"}], "}"}], ",", "\n", 
    RowBox[{"{", 
     RowBox[{
     "0.016818791", ",", " ", "0.665234556", ",", " ", "0.092434248", ",", 
      " ", "0.133012060", ",", " ", "0.092500346"}], "}"}], ",", "\n", 
    RowBox[{"{", " ", 
     RowBox[{
     "0.016151808", ",", " ", "0.655223800", " ", ",", "0.089922546", ",", 
      " ", "0.136755578", ",", " ", "0.101946269"}], "}"}], ",", "\n", 
    RowBox[{"{", 
     RowBox[{
     "0.021169203", ",", " ", "0.639853144", " ", ",", "0.086779914", " ", 
      ",", "0.142385877", " ", ",", "0.109811863"}], "}"}], ",", "\n", 
    RowBox[{"{", 
     RowBox[{
     "0.016055666", ",", " ", "0.633453711", ",", " ", "0.083601228", " ", 
      ",", "0.149290054", " ", ",", "0.117599341"}], "}"}], ",", "\n", 
    RowBox[{"{", " ", 
     RowBox[{
     "0.014523408", ",", " ", "0.627360730", ",", " ", "0.079082568", " ", 
      ",", "0.152264438", " ", ",", "0.126768857"}], "}"}], ",", "\n", 
    RowBox[{"{", " ", 
     RowBox[{
     "0.015376665", ",", " ", "0.617734541", ",", " ", "0.077388070", ",", 
      " ", "0.155142680", ",", " ", "0.134358044"}], "}"}], ",", "\n", 
    RowBox[{"{", 
     RowBox[{
     "0.012588556", ",", " ", "0.612675083", ",", " ", "0.074563907", ",", 
      " ", "0.156903275", ",", " ", "0.143269179"}], "}"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.677533312891513*^9, 3.677533332295896*^9}, {
  3.677533362872052*^9, 3.677533409939167*^9}, {3.677539228246418*^9, 
  3.6775393873531713`*^9}, {3.6775441048153553`*^9, 3.6775443431629963`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.`", ",", "1.`", ",", "0.`", ",", "0.`", ",", "0.`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.87850091`", ",", "0.103550634`", ",", "0.`", ",", 
     "0.017948456`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.01219798`", ",", "0.84401608`", ",", "0.120177141`", ",", "0.`", ",", 
     "0.023608799`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.023843145`", ",", "0.813659334`", ",", "0.124167022`", ",", 
     "0.009223596`", ",", "0.029106904`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.0189279`", ",", "0.786397149`", ",", "0.133847291`", ",", 
     "0.024780526`", ",", "0.036047133`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.044910198`", ",", "0.75942339`", ",", "0.11476917`", ",", 
     "0.038648969`", ",", "0.042248274`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.027045866`", ",", "0.747297517`", ",", "0.105906106`", ",", 
     "0.070219504`", ",", "0.049531009`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.022935807`", ",", "0.728069174`", ",", "0.108015214`", ",", 
     "0.084857079`", ",", "0.056122725`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.025862121`", ",", "0.7117371`", ",", "0.103484536`", ",", 
     "0.095426659`", ",", "0.063489584`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.020646433`", ",", "0.702363283`", ",", "0.096700537`", ",", 
     "0.109078782`", ",", "0.071210965`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.019120183`", ",", "0.692677006`", ",", "0.09189946`", ",", 
     "0.118248298`", ",", "0.078055053`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.019805193`", ",", "0.679812043`", ",", "0.088979155`", ",", 
     "0.126161963`", ",", "0.085241646`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.016818791`", ",", "0.665234556`", ",", "0.092434248`", ",", 
     "0.13301206`", ",", "0.092500346`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.016151808`", ",", "0.6552238`", ",", "0.089922546`", ",", 
     "0.136755578`", ",", "0.101946269`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.021169203`", ",", "0.639853144`", ",", "0.086779914`", ",", 
     "0.142385877`", ",", "0.109811863`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.016055666`", ",", "0.633453711`", ",", "0.083601228`", ",", 
     "0.149290054`", ",", "0.117599341`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.014523408`", ",", "0.62736073`", ",", "0.079082568`", ",", 
     "0.152264438`", ",", "0.126768857`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.015376665`", ",", "0.617734541`", ",", "0.07738807`", ",", 
     "0.15514268`", ",", "0.134358044`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.012588556`", ",", "0.612675083`", ",", "0.074563907`", ",", 
     "0.156903275`", ",", "0.143269179`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.677533411455312*^9, 3.6775443469325*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"g", "[", 
   RowBox[{
   "p1_", ",", "p2_", ",", "p3_", ",", "p4_", ",", "p5_", ",", "p6_", ",", 
    "p7_", ",", "p8_", ",", "p9_", ",", "p10_", ",", "p11_", ",", "p12_", ",",
     "p13_", ",", " ", "q1_", ",", "q2_", ",", "q3_", ",", "q4_", ",", 
    "\[IndentingNewLine]", "q5_", ",", "q6_", ",", "q7_", ",", "q8_", ",", 
    "q9_", ",", "q10_", ",", "q11_", ",", "q12_", ",", "q13_", ",", "w_"}], 
   "]"}], ":=", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"sum", " ", "=", " ", "0"}], ";", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"i", "=", "1"}], ";", 
       RowBox[{"templeft", "=", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0", ",", "0"}], "}"}]}], ";", 
       
       RowBox[{"tempright", "=", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0", ",", "0"}], "}"}]}]}], 
      ",", 
      RowBox[{"i", "<", "12"}], ",", 
      RowBox[{"i", "++"}], ",", 
      RowBox[{
       RowBox[{"sum", "=", 
        RowBox[{"sum", "+", 
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"w", " ", "*", " ", "templeft"}], " ", "+", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "w"}], ")"}], " ", "*", " ", "tempright"}], 
             "-", 
             RowBox[{"observed2", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "^", "2"}], "]"}]}]}], 
       ";", 
       RowBox[{"templeft", "=", 
        RowBox[{"Dot", "[", 
         RowBox[{"templeft", ",", "P"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"tempright", " ", "=", " ", 
        RowBox[{"Dot", "[", 
         RowBox[{"tempright", ",", "Q"}], "]"}]}]}]}], "]"}], ";", " ", 
    "sum"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.677533413622778*^9, 3.677533426736545*^9}, {
  3.677544358485742*^9, 3.677544368540716*^9}, {3.677544993230998*^9, 
  3.677545012783784*^9}, {3.677548871257633*^9, 3.6775488830242863`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Minimize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"g", "[", 
      RowBox[{
      "p1", ",", "p2", ",", "p3", ",", "p4", ",", "p5", ",", "p6", ",", "p7", 
       ",", "p8", ",", "p9", ",", "p10", ",", "p11", ",", "p12", ",", "p13", 
       ",", "q1", ",", "q2", ",", "q3", ",", "q4", ",", "q5", ",", "q6", ",", 
       "q7", ",", "q8", ",", "q9", ",", "q10", ",", "q11", ",", "q12", ",", 
       "q13", ",", " ", "w"}], "]"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"p1", "+", "p2", " ", "+", "p3", " ", "+", "p4"}], 
       "\[LessEqual]", " ", "1"}], "&&", 
      RowBox[{"p1", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"p2", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"p3", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"p4", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"p5", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"p6", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"p7", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"p8", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"p9", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"p10", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"p11", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"p12", "\[GreaterEqual]", "0"}], "&&", " ", 
      RowBox[{"p13", " ", "\[GreaterEqual]", "0"}], "\[IndentingNewLine]", "&&",
       " ", 
      RowBox[{
       RowBox[{"p5", "+", "p6"}], "\[LessEqual]", "1"}], "&&", 
      RowBox[{
       RowBox[{"p7", "+", "p8", "+", "p9"}], " ", "\[LessEqual]", "1"}], "&&",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"p10", "+", "p11", "+", "p12", "+", "p13"}], "\[LessEqual]", 
       "1"}], " ", "&&", " ", 
      RowBox[{
       RowBox[{"q1", "+", "q2", " ", "+", "q3", " ", "+", "q4"}], 
       "\[LessEqual]", " ", "1"}], "&&", 
      RowBox[{"q1", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"q2", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"q3", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"q4", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"q5", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"q6", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"q7", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"q8", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"q9", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"q10", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"q11", "\[GreaterEqual]", "0"}], "&&", 
      RowBox[{"q12", "\[GreaterEqual]", "0"}], "&&", " ", 
      RowBox[{"q13", " ", "\[GreaterEqual]", "0"}], "\[IndentingNewLine]", "&&",
       " ", 
      RowBox[{
       RowBox[{"q5", "+", "q6"}], "\[LessEqual]", "1"}], "&&", 
      RowBox[{
       RowBox[{"q7", "+", "q8", "+", "q9"}], " ", "\[LessEqual]", "1"}], "&&",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"q10", "+", "q11", "+", "q12", "+", "q13"}], "\[LessEqual]", 
       "1"}], " ", "&&", " ", 
      RowBox[{"w", " ", "\[GreaterEqual]", " ", "0"}], " ", "&&", " ", 
      RowBox[{"w", "\[LessEqual]", "1"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "p1", ",", "p2", ",", "p3", ",", "p4", ",", "p5", ",", "p6", ",", "p7", 
     ",", "p8", ",", "p9", ",", "p10", ",", "p11", ",", "p12", ",", "p13", 
     ",", "q1", ",", "q2", ",", "q3", ",", "q4", ",", "q5", ",", "q6", ",", 
     "q7", ",", "q8", ",", "q9", ",", "q10", ",", "q11", ",", "q12", ",", 
     "q13", ",", " ", "w"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6775443908212347`*^9, 3.67754439094044*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0010690734147915774`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"p1", "\[Rule]", "0.21079006868987027`"}], ",", 
     RowBox[{"p2", "\[Rule]", "0.3338289493504188`"}], ",", 
     RowBox[{"p3", "\[Rule]", "0.22484854914778982`"}], ",", 
     RowBox[{"p4", "\[Rule]", "0.19802472842060267`"}], ",", 
     RowBox[{"p5", "\[Rule]", "0.3161871476603059`"}], ",", 
     RowBox[{"p6", "\[Rule]", "0.5015943669013405`"}], ",", 
     RowBox[{"p7", "\[Rule]", "0.04679315242767428`"}], ",", 
     RowBox[{"p8", "\[Rule]", "0.34126832745696145`"}], ",", 
     RowBox[{"p9", "\[Rule]", "0.4513365945592068`"}], ",", 
     RowBox[{"p10", "\[Rule]", "0.37992973890906206`"}], ",", 
     RowBox[{"p11", "\[Rule]", "0.15004819673322622`"}], ",", 
     RowBox[{"p12", "\[Rule]", "0.12597737972886586`"}], ",", 
     RowBox[{"p13", "\[Rule]", "0.21700392432020865`"}], ",", 
     RowBox[{"q1", "\[Rule]", "0.19903866595381026`"}], ",", 
     RowBox[{"q2", "\[Rule]", "7.864841849069128`*^-7"}], ",", 
     RowBox[{"q3", "\[Rule]", "0.00006774575325703617`"}], ",", 
     RowBox[{"q4", "\[Rule]", "0.8008920540039911`"}], ",", 
     RowBox[{"q5", "\[Rule]", "0.9234536359334923`"}], ",", 
     RowBox[{"q6", "\[Rule]", "0.07625398155860279`"}], ",", 
     RowBox[{"q7", "\[Rule]", "0.2078439805507819`"}], ",", 
     RowBox[{"q8", "\[Rule]", "0.38657497745281766`"}], ",", 
     RowBox[{"q9", "\[Rule]", "0.40558053864255167`"}], ",", 
     RowBox[{"q10", "\[Rule]", "7.295419842222635`*^-9"}], ",", 
     RowBox[{"q11", "\[Rule]", "0.04629798761365427`"}], ",", 
     RowBox[{"q12", "\[Rule]", "0.`"}], ",", 
     RowBox[{"q13", "\[Rule]", "0.9203076097128426`"}], ",", 
     RowBox[{"w", "\[Rule]", "0.06937152006260422`"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.677544561420664*^9, 3.677545083815832*^9, 
  3.6775489450160437`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"0.010916246387811008", "+", "0.08459416318787649", "+", " ", 
  "0.9044896013633505"}]], "Input",
 CellChangeTimes->{{3.6775462275682487`*^9, 3.677546234350793*^9}}],

Cell[BoxData["1.0000000109390381`"], "Output",
 CellChangeTimes->{3.6775462358557*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NumberForm", "[", 
  RowBox[{"1.0000000109390381`", ",", "16"}], "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 TagBox[
  InterpretationBox["\<\"1.000000010939038\"\>",
   1.0000000109390381`,
   AutoDelete->True],
  NumberForm[#, 16]& ]], "Output",
 CellChangeTimes->{3.677546255013876*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"p1", "\[Rule]", "0.413948891957055`"}], ",", 
  RowBox[{"p2", "\[Rule]", "0.`"}], ",", 
  RowBox[{"p3", "\[Rule]", "0.0858493757902534`"}], ",", 
  RowBox[{"p4", "\[Rule]", "0.08477551171562205`"}], ",", 
  RowBox[{"p5", "\[Rule]", "0.4627967148177392`"}], ",", 
  RowBox[{"p6", "\[Rule]", "0.3116581796844115`"}], ",", 
  RowBox[{"p7", "\[Rule]", "0.09668629401880811`"}], ",", 
  RowBox[{"p8", "\[Rule]", "0.28914741240768765`"}], ",", 
  RowBox[{"p9", "\[Rule]", "0.3868636525130269`"}], ",", 
  RowBox[{"p10", "\[Rule]", "6.518941181629574`*^-6"}], ",", 
  RowBox[{"p11", "\[Rule]", "0.`"}], ",", 
  RowBox[{"p12", "\[Rule]", "0.`"}], ",", 
  RowBox[{"p13", "\[Rule]", "0.17848107883314474`"}], ",", 
  RowBox[{"q1", "\[Rule]", "0.033849461116735646`"}], ",", 
  RowBox[{"q2", "\[Rule]", "3.13332873213756`*^-6"}], ",", 
  RowBox[{"q3", "\[Rule]", "0.22819380542635867`"}], ",", 
  RowBox[{"q4", "\[Rule]", "4.836413355860894`*^-6"}], ",", 
  RowBox[{"q5", "\[Rule]", "0.9837397517598742`"}], ",", 
  RowBox[{"q6", "\[Rule]", "0.`"}], ",", 
  RowBox[{"q7", "\[Rule]", "0.10620768325816181`"}], ",", 
  RowBox[{"q8", "\[Rule]", "0.06138115925326018`"}], ",", 
  RowBox[{"q9", "\[Rule]", "0.5139705066223046`"}], ",", 
  RowBox[{"q10", "\[Rule]", "0.`"}], ",", 
  RowBox[{"q11", "\[Rule]", "0.010916246387811008`"}], ",", 
  RowBox[{"q12", "\[Rule]", "0.08459416318787649`"}], ",", 
  RowBox[{"q13", "\[Rule]", "0.9044896013633505`"}], ",", 
  RowBox[{"w", "\[Rule]", "0.19432781495560675`"}]}]], "Input"]
},
WindowSize->{1280, 701},
WindowMargins->{{11, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (December 4, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1127, 31, 63, "Input"],
Cell[1710, 55, 874, 21, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2621, 81, 1083, 30, 46, "Input"],
Cell[3707, 113, 805, 20, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4549, 138, 254, 6, 28, "Input"],
Cell[4806, 146, 272, 6, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5115, 157, 5694, 148, 318, "Input"],
Cell[10812, 307, 5682, 149, 318, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16531, 461, 152, 3, 28, "Input"],
Cell[16686, 466, 201, 5, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16924, 476, 1208, 31, 114, "Input"],
Cell[CellGroupData[{
Cell[18157, 511, 93, 1, 21, "Print"],
Cell[18253, 514, 93, 1, 21, "Print"],
Cell[18349, 517, 93, 1, 21, "Print"],
Cell[18445, 520, 95, 1, 21, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[18589, 527, 196, 4, 28, "Input"],
Cell[18788, 533, 1053, 26, 46, "Output"]
}, Open  ]],
Cell[19856, 562, 2146, 50, 131, "Input"],
Cell[CellGroupData[{
Cell[22027, 616, 3792, 77, 148, "Input"],
Cell[25822, 695, 1804, 33, 76, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27663, 733, 357, 10, 28, "Input"],
Cell[28023, 745, 302, 9, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28362, 759, 3693, 83, 335, "Input"],
Cell[32058, 844, 2965, 78, 165, "Output"]
}, Open  ]],
Cell[35038, 925, 2040, 52, 131, "Input"],
Cell[CellGroupData[{
Cell[37103, 981, 3462, 72, 148, "Input"],
Cell[40568, 1055, 1880, 34, 77, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42485, 1094, 189, 3, 28, "Input"],
Cell[42677, 1099, 86, 1, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42800, 1105, 126, 3, 28, "Input"],
Cell[42929, 1110, 194, 6, 39, "Output"]
}, Open  ]],
Cell[43138, 1119, 1542, 28, 114, "Input"]
}
]
*)

(* End of internal cache information *)
